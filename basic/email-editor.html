<html>
	<head>
		<title>Email Editor - Chamaileon SDK</title>
		<link rel="preconnect" href="https://fonts.gstatic.com">
		<link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
		<link href="/css/style.css" rel="stylesheet">

		<style>
			#example {
				display: none;
			}

			#exampleJson {
				width: 48%;
				height: 300px;
			}

			#content {
				display: flex;
				justify-content: space-between;
			}

			#description {
				width: 48%;
			}

			#showExample {
				display: none;
			}
		</style>
	</head>
	<body>
		<header>
			<a id="github-link" href="https://github.com/chamaileon-sdk/examples"><img loading="lazy" width="149" height="149" src="https://github.blog/wp-content/uploads/2008/12/forkme_left_white_ffffff.png?resize=149%2C149" class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
			<div id="logo-wrapper">
				<a href="/">
					<div id="logo"></div>
					<div id="logo-badge">SDK Examples</div>
				</a>
			</div>
			<button id="settings-button">Settings</button>
		</header>
		<main id="main">
			<h1>Email Editor</h1>

			<section id="content">
				<textarea id="exampleJson">Loading...</textarea>
				<div id="description">
					<p>In this example, the JSON in the textarea on the left hand side will be loaded into the email editor, when you click the 'Open Email Editor' button.</p>
					<p>When the 'onSave' hook is invoked, the textarea will be updated with the new JSON.</p>
					<button id="showExample">Open Email Editor</button>
				</div>
			</section>
		</main>
		<footer>
			All rights reserved.
			<div id="footer-logo"></div>
		</footer>

		<script src='https://plugins.chamaileon.io/static/chamaileonSdk.js'></script>
		<script src="/js/chamaileonLogo.js"></script>
		<script src="/js/initDemo.js"></script>
		<script src="/js/initChamaileonSDK.js"></script>
		<script>
			async function main() {
				const documentUrl = 'https://chamaileon-sdk.github.io/example-jsons/jsons/business-promo.json'
	
				const chamaileonPlugins = await initChamaileonSdk()
	
				const documentResponse = await fetch(documentUrl, { method: 'GET' })
				const documentJson = await documentResponse.json()

				const exampleJsonTextArea = document.getElementById('exampleJson')

				exampleJsonTextArea.value = JSON.stringify(documentJson)

				const showExampleButton = document.getElementById('showExample')
				showExampleButton.style.display = 'inline-block'
				showExampleButton.onclick = () => {
					const documentJson = JSON.parse(exampleJsonTextArea.value)

					documentJson.title = 'demo'

					chamaileonPlugins.editEmail({
						document: documentJson,
						hooks: {
							onSave: (params) => {
								exampleJsonTextArea.value = JSON.stringify(params.emailJson)
							}
						}
					})
				}
			}
			main()
		</script>
	</body>
</html>